import{_ as A}from"./AuthenticatedLayout-Bo52xLDn.js";import{l as C,f as g,g as S,c as o,o as a,a as _,u as q,m as D,w as x,b as t,F as c,r as B,t as n,n as N,j as f,k as P}from"./app-C7YuJVyk.js";import{S as u}from"./sweetalert2.esm.all-B0Dix5B2.js";const E={class:"py-12"},H={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},L={class:"bg-white shadow-md sm:rounded-lg p-6"},U={key:0},V={class:"w-full border-collapse border border-gray-300"},Y={class:"py-4 px-5 text-gray-700"},F={class:"py-4 px-5 text-gray-800 font-medium"},M={class:"py-4 px-5 text-gray-800 font-semibold"},R={class:"py-4 px-5"},T={class:"py-4 px-5 text-gray-700"},$={class:"py-4 px-5 text-center"},j=["onClick","disabled"],z={key:0},G={key:1},I={key:0},J={class:"text-gray-600"},K={key:2,class:"text-green-500 font-semibold"},O={key:3,class:"text-gray-600 font-semibold"},Q={key:1,class:"text-center py-6"},et={__name:"AssessmentHistory",setup(W){const h=C(),y=g(h.props.assessments||[]),i=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"No date available",v=r=>{switch(r){case"Mild":return"bg-blue-300 text-gray-700";case"Moderate":return"bg-blue-300 text-gray-700";case"Severe":return"bg-blue-300 text-gray-700";default:return"bg-blue-300 text-gray-700"}},m=S(()=>[...y.value].sort((r,s)=>new Date(s.created_at)-new Date(r.created_at))),l=g(!1),w=async r=>{var e,p;if((await u.fire({title:"Are you sure?",text:"Do you want to request an appointment for this assessment?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, request appointment!"})).isConfirmed)try{if(l.value=!0,(await P.post(route("appointments.request"),{assessment_id:r})).status===200){const b=y.value.find(k=>k.id===r);b&&(b.appointment_status="pending"),u.fire("Appointment Requested!","Your appointment request has been sent and is pending approval.","success")}}catch(d){console.error("Error requesting appointment:",d),u.fire("Error!",((p=(e=d.response)==null?void 0:e.data)==null?void 0:p.message)||"An unexpected error occurred. Please try again.","error")}finally{l.value=!1}};return(r,s)=>(a(),o(c,null,[_(q(D),{title:"Assessment History"}),_(A,null,{header:x(()=>s[0]||(s[0]=[t("h2",{class:"text-2xl font-bold leading-tight text-gray-700 dark:text-white"}," Assessment History ",-1)])),default:x(()=>[t("div",E,[t("div",H,[t("div",L,[s[4]||(s[4]=t("h3",{class:"text-xl font-semibold text-gray-800 mb-4"}," Your Past Assessments ",-1)),m.value.length>0?(a(),o("div",U,[t("table",V,[s[2]||(s[2]=t("thead",null,[t("tr",{class:"bg-gray-100 text-gray-800 text-left"},[t("th",{scope:"col",class:"py-4 px-5 border-b"},"Date"),t("th",{scope:"col",class:"py-4 px-5 border-b"},"Type"),t("th",{scope:"col",class:"py-4 px-5 border-b"},"Score"),t("th",{scope:"col",class:"py-4 px-5 border-b"},"Severity"),t("th",{scope:"col",class:"py-4 px-5 border-b"},"Impact"),t("th",{scope:"col",class:"py-4 px-5 border-b"},"Appointment Status")])],-1)),t("tbody",null,[(a(!0),o(c,null,B(m.value,e=>(a(),o("tr",{key:e.id,class:"border-b border-gray-300 hover:bg-gray-100 transition"},[t("td",Y,n(i(e.created_at)),1),t("td",F,n(e.assessment_type||"Unknown"),1),t("td",M,n(e.total_score??"N/A"),1),t("td",R,[t("span",{class:N(["px-4 py-2 rounded-lg text-sm font-semibold",v(e.severity)])},n(e.severity||"Unknown"),3)]),t("td",T,n(e.impact??"Not Available"),1),t("td",$,[e.appointment_status==="none"?(a(),o("button",{key:0,onClick:p=>w(e.id),disabled:l.value,class:"bg-blue-500 hover:bg-blue-400 text-white px-4 py-2 rounded-lg transition focus:ring-2 focus:ring-blue-300 disabled:bg-gray-300 disabled:cursor-not-allowed"},[l.value?(a(),o("span",z,"Processing...")):(a(),o("span",G,"Request Appointment"))],8,j)):e.appointment_status==="pending"?(a(),o(c,{key:1},[s[1]||(s[1]=t("span",{class:"text-yellow-500 font-semibold"}," Pending Approval ",-1)),e.appointment_date?(a(),o("div",I,[t("span",J,"Scheduled for: "+n(i(e.appointment_date)),1)])):f("",!0)],64)):e.appointment_status==="approved"?(a(),o("span",K," Approved - "+n(i(e.schedule_at)),1)):e.appointment_status==="completed"?(a(),o("span",O,"Completed")):f("",!0)])]))),128))])])])):(a(),o("div",Q,s[3]||(s[3]=[t("p",{class:"text-gray-700"},"No past assessments found.",-1)])))])])])]),_:1})],64))}};export{et as default};
